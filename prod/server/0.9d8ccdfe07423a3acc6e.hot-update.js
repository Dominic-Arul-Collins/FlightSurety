exports.id=0,exports.modules={"./src/server/server.js":function(e,o,n){"use strict";n.r(o);var c=n("./build/contracts/FlightSuretyApp.json"),t=n("./build/contracts/FlightSuretyData.json"),s=n("./src/server/config.json"),l=n("web3"),r=n.n(l),a=n("express"),u=n.n(a),i=n("cors"),f=[{id:0,name:"MGRT001"},{id:1,name:"SBCT002"},{id:2,name:"NGLT003"},{id:3,name:"CGLT005"},{id:4,name:"TENT007"},{id:5,name:"KRLT009"}],g=s.localhost,d=new r.a(new r.a.providers.WebsocketProvider(g.url.replace("http","ws")));d.eth.defaultAccount=d.eth.accounts[0];var h=new d.eth.Contract(c.abi,g.appAddress),m=new d.eth.Contract(t.abi,g.dataAddress),p=[],v=null;new Promise((function(e,o){d.eth.getAccounts().then((function(n){var c=20,t=[];h.methods.REGISTRATION_FEE().call().then((function(s){n.forEach((function(n){h.methods.registerOracle().send({from:n,value:s,gas:6721975,gasPrice:1e4}).then((function(){h.methods.getMyIndexes().call({from:n}).then((function(o){t.push(o),p.push(n),console.log("Oracle Data: Index ".concat(o[0],", ").concat(o[1],", ").concat(o[2]," using account ").concat(n)),(c-=1)||e(t)})).catch((function(e){o(e)}))})).catch((function(e){o(e)}))}))})).catch((function(e){o(e)}))})).catch((function(e){o(e)}))})).then((function(e){console.log("Oracles Registered - Success"),R.get("/api",(function(e,o){o.send({message:"Success - Response for /api call"})})),R.get("/flights",(function(e,o){o.json({result:f})})),R.get("/eventIndex",(function(e,o){o.json({result:v})})),console.log("Success - API Initialize"),h.events.SubmitOracleResponse({fromBlock:"latest"},(function(e,o){e&&console.log(e),console.log(o);for(var n=o.returnValues.airline,c=o.returnValues.flight,t=o.returnValues.timestamp,s=o.returnValues.indexes,l=o.returnValues.statusCode,r=0;r<p.length;r++)console.log("Oracle loop ",r),h.methods.submitOracleResponse(s,n,c,t,l).send({from:p[r]}).then((function(e){console.log(e)})).catch((function(e){console.log("No response from Oracle")}))})),h.events.RegisterAirline({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)})),m.events.FundedAirLines({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)})),m.events.PurchaseInsurance({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)})),h.events.CreditInsurees({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)})),m.events.Withdraw({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)})),h.events.OracleRequest({fromBlock:0},(function(e,o){e&&console.log(e),v=o.returnValues.index,console.log(o)})),h.events.OracleReport({fromBlock:0},(function(e,o){e&&console.log(e),console.log(o)}))})).catch((function(e){console.log(e.message)}));var R=u()();R.use(i()),o.default=R}};